---
title: "Time Series Analysis of Cryptocurrencies"
author: "Omkar Mutreja"
date: "2/3/2019"
output: html_document
---

Loading the packages required for Time Series Analysis
```{r}
library(magrittr)
library(dplyr)
library(zoo)
library(xts)
#library(PairTrading)
library(devtools)
library(ggplot2)
library(astsa)
library(tseries)
library(forecast)
library(fUnitRoots)
library(urca)
#library(MTS)
library(corrplot)
#library(caret)
library(sqldf)
```

Loading the Cryptocurrency Datasets
```{r}
bitcoin <- read.csv('bitcoin_price.csv')
ethereum <- read.csv('ethereum_price.csv')
litecoin <- read.csv('litecoin_price.csv')
ripple <- read.csv('ripple_price.csv')
monero <- read.csv('monero_price.csv')
dash <- read.csv('dash_price.csv')
```

```{r}
head(bitcoin)
str(bitcoin)
summary(bitcoin)
```

Converting Date column from factor to date
```{r}
bitcoin$Date <- as.Date(bitcoin$Date, format='%b %d, %Y')
ethereum$Date <- as.Date(ethereum$Date, format = '%b %d, %Y')
litecoin$Date <- as.Date(litecoin$Date, format = '%b %d, %Y')
ripple$Date <- as.Date(ripple$Date, format = '%b %d, %Y')
monero$Date <- as.Date(monero$Date, format = '%b %d, %Y')
dash$Date <- as.Date(dash$Date, format = '%d-%b-%y')
```

Analyzing both the datasets for the same interval (August 7, 2017 onwards)
Ethereum starts from the above date
Creating subset for bitcoin for that interval

```{r}
bitcoin_new <- bitcoin[bitcoin$Date > "2015-08-06",] 
View(bitcoin_new)
litecoin_new <- litecoin[litecoin$Date > "2015-08-06",]
ripple_new <- ripple[ripple$Date > "2015-08-06",]
monero_new <- monero[monero$Date > "2015-08-06",]
dash_new <- dash[dash$Date > "2015-08-06",]
```

Now both the cryptocurrencies are in the same interval and have 929 entries

Sorting both the datasets
```{r}
bitcoin_new_ordered <- sqldf("Select * from bitcoin_new order by Date asc")
ethereum_ordered <- sqldf("Select * from ethereum order by Date asc")
litecoin_ordered <- sqldf("Select * from litecoin_new order by Date asc")
ripple_ordered <- sqldf("Select * from ripple_new order by Date asc")
monero_ordered <- sqldf("Select * from monero_new order by Date asc")
dash_ordered <- sqldf("Select * from dash_new order by Date asc")
```

Merging both the datasets
```{r}
cryptocurrency <- bitcoin_new_ordered %>% 
  left_join(ethereum_ordered,by=c('Date'='Date')) %>%
  left_join(litecoin_ordered,by=c('Date'='Date')) %>%
  left_join(ripple_ordered,by=c('Date'='Date')) %>%
  left_join(monero_ordered,by=c('Date'='Date')) %>%
  left_join(dash_ordered,by=c('Date'='Date'))
```

Changing column names
```{r}
cols <- c(sapply(colnames(bitcoin_new_ordered), function(x) paste0(x,"_bitcoin")),
          sapply(colnames(ethereum_ordered)[-1], function(x) paste0(x,"_ethreum")),
          sapply(colnames(litecoin_ordered)[-1], function(x) paste0(x,"_litecoin")),
          sapply(colnames(ripple_ordered)[-1], function(x) paste0(x,"_ripple")),
          sapply(colnames(monero_ordered)[-1], function(x) paste0(x,"_monero")),
          sapply(colnames(dash_ordered)[-1], function(x) paste0(x,"_dash")))

colnames(cryptocurrency) <- cols
```

Plotting the time series plot for both the series

```{r}
bitcoin_graph <- ggplot(data = bitcoin_new_ordered, x = Date_bitcoin) +
  geom_line(aes(x = Date_bitcoin, y = Close, col = 'red')) 

ggplot(data = cryptocurrency, aes(x = Date_bitcoin)) +
  geom_line(aes(y = Close_ethreum), color = 'red') +
  geom_line(aes(y = Close_litecoin), color = 'green') +
  geom_line(aes(y = Close_ripple), color = 'black') +
  geom_line(aes(y = Close_monero), color = 'cyan') +
  geom_line(aes(y = Close_dash), color = 'blue')  +ggtitle('Close Price')
```

